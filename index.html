<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å¯¾æˆ¦ã˜ã‚ƒã‚“ã‘ã‚“</title>
	<style>
		input[type="radio"] {
			display: none;
		}

		#result,
		#gameover {
			display: none;
		}

		#gameover {
			font-size: 2rem;
		}
	</style>
</head>
<body>
	<h1>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼å¯¾æˆ¦ã˜ã‚ƒã‚“ã‘ã‚“</h1>
	<p><small>æœ€å¤§ã§20è©¦åˆã—ã€å¾—ç‚¹ã®é«˜ã„æ–¹ã‹ã€å…ˆã«10ç‚¹å–ã£ãŸæ–¹ãŒã‚²ãƒ¼ãƒ ã®å‹è€…ã§ã™ã€‚</small></p>
	<p>å¯¾æˆ¦å›æ•°: <span id="game_counter">1</span>å›ç›®/20å›
	ã‚ãªãŸï¼š<meter min="0" max="10" value="0" high="8" id="player1_meter"></meter> (<span id="player1_meter_value">0</span>ç‚¹)
	ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ï¼š<meter min="0" max="10" value="0" high="8" id="player2_meter"></meter> (<span id="player2_meter_value">0</span>ç‚¹)</p>
	<div id="select_hand">
		<p>ã˜ã‚ƒã‚“ã‘ã‚“...</p>
		<p>ã‚ãªãŸ:
			<label><input type="radio" name="hand" value="ğŸ‘Š"><img src="images/janken_gu.png" width="64" alt=""></label>
			<label><input type="radio" name="hand" value="âœŒ"><img src="images/janken_choki.png" width="64" alt=""></label>
			<label><input type="radio" name="hand" value="âœ‹"><img src="images/janken_pa.png" width="64" alt=""></label>
		</p>
	</div>
	<div id="result">
		<p>ã˜ã‚ƒã‚“ã‘ã‚“...ã½ã‚“ï¼</p>
		<p id="play"></p>
		<p id="judge"></p>
		<div id="restart_button">
			<hr>
			<button type="button" id="restart">å†ãƒãƒ£ãƒ¬ãƒ³ã‚¸</button>
		</div>
	</div>
	<div id="gameover">
		<hr>
		<p>ã‚²ãƒ¼ãƒ çµ‚äº†</p>
		<p>ã‚²ãƒ¼ãƒ ã®å‹è€…ã¯ ... <span id="winner"></span>ã§ã™ï¼</p>
		<button type="button" id="restart_game">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤ã™ã‚‹</button>
	</div>
	<script>
	let counter = 1
	let player1_win = 0
	let player2_win = 0
	const hand = ['ğŸ‘Š','âœŒ','âœ‹']
	const hand_img = [
		'<img src="images/janken_gu.png" width="64" alt="">',
		'<img src="images/janken_choki.png" width="64" alt="">',
		'<img src="images/janken_pa.png" width="64" alt="">'
	]

	const user_hand = document.querySelectorAll('[name=hand]')
	user_hand.forEach( i => i.addEventListener('click', e => judge() ))

	function judge(){
		let player1_index
		if(user_hand[0].checked === true){
			player1_index = 0
		}else if(user_hand[1].checked === true){
			player1_index = 1
		}else{
			player1_index = 2
		}

		const player2_index = Math.floor(Math.random()*3)
		const player1 = hand[player1_index]
		const player2 = hand[player2_index]

		const play = document.getElementById('play')
		const judge = document.getElementById('judge')

		play.innerHTML = `ã‚ãªãŸ:${hand_img[player1_index]}<br>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼:${hand_img[player2_index]}`

		if( player1 === player2 ){
			judge.innerText = 'ã‚ã„ã“'
		}else if( player1 === 'ğŸ‘Š' && player2 === 'âœŒ'){
			judge.innerText = 'ã‚ãªãŸã®å‹ã¡ï¼'
			player1_win++
		}else if( player1 === 'ğŸ‘Š' && player2 === 'âœ‹'){
			judge.innerText = 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®å‹ã¡ï¼'
			player2_win++
		}else if( player1 === 'âœŒ' && player2 === 'ğŸ‘Š'){
			judge.innerText = 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®å‹ã¡ï¼'
			player2_win++
		}else if( player1 === 'âœŒ' && player2 === 'âœ‹'){
			judge.innerText = 'ã‚ãªãŸã®å‹ã¡ï¼'
			player1_win++
		}else if( player1 === 'âœ‹' && player2 === 'ğŸ‘Š'){
			judge.innerText = 'ã‚ãªãŸã®å‹ã¡ï¼'
			player1_win++
		}else if( player1 === 'âœ‹' && player2 === 'âœŒ'){
			judge.innerText = 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã®å‹ã¡ï¼'
			player2_win++
		}

		// ãƒ¡ãƒ¼ã‚¿ãƒ¼é€²æ—
		const player1_meter = document.getElementById('player1_meter')
		const player2_meter = document.getElementById('player2_meter')
		player1_meter.value = player1_win
		player2_meter.value = player2_win
		const player1_meter_value = document.getElementById('player1_meter_value')
		const player2_meter_value = document.getElementById('player2_meter_value')
		player1_meter_value.innerHTML = player1_win
		player2_meter_value.innerHTML = player2_win

		// è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
		const select_hand = document.getElementById('select_hand')
		const result = document.getElementById('result')
		select_hand.style.display = 'none'
		result.style.display = 'block'

		// ã‚²ãƒ¼ãƒ ã®çµ‚äº†å‡¦ç†
		// å…ˆã«10ç‚¹ã¨ã‚‹ã‹ã€20å›è©¦åˆã—ãŸå ´åˆã¯ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã§ã™
		if(player1_win >= 10 || player2_win >= 10 || counter === 20){
			gameover()
		}
	}

	function gameover(){
		// è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
		const restart_button = document.getElementById('restart_button')
		const gameover = document.getElementById('gameover')
		restart_button.style.display = 'none'
		gameover.style.display = 'block'
		const winner = document.getElementById('winner')
		if(player1_win === player2_win){
			winner.innerHTML = 'ã²ãã‚ã‘'
		}else{
			winner.innerHTML = player1_win > player2_win ? 'ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼' : 'ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼'
		}

		// çŠ¶æ…‹åˆæœŸåŒ–
		counter = 0
		player1_win = 0
		player2_win = 0
	}

	const restart_game = document.getElementById('restart_game')
	restart_game.addEventListener('click', e => {
		reset()
	})

	const restart = document.getElementById('restart')
	restart.addEventListener('click', e => {
		reset()
	})

	function reset(){
		// çŠ¶æ…‹ã‚’åˆæœŸåŒ–
		user_hand.forEach( i => i.checked = false)
		// è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
		const select_hand = document.getElementById('select_hand')
		const result = document.getElementById('result')
		select_hand.style.display = 'block'
		result.style.display = 'none'
		const player1_meter = document.getElementById('player1_meter')
		const player2_meter = document.getElementById('player2_meter')
		player1_meter.value = player1_win
		player2_meter.value = player2_win
		const player1_meter_value = document.getElementById('player1_meter_value')
		const player2_meter_value = document.getElementById('player2_meter_value')
		player1_meter_value.innerHTML = player1_win
		player2_meter_value.innerHTML = player2_win
		const restart_button = document.getElementById('restart_button')
		const gameover = document.getElementById('gameover')
		restart_button.style.display = 'block'
		gameover.style.display = 'none'
		// å¯¾æˆ¦å›æ•°ã‚’åŠ ç®—
		const game_counter = document.getElementById('game_counter')
		game_counter.innerHTML = ++counter
	}
	</script>
</body>
</html>
